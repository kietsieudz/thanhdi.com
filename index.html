<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Trang chủ chính thức - TDStudio</title>

    <!-- Styles -->
    <link rel="stylesheet" href="styles.css" />

    <!-- Open Graph (fix URL dư '>') -->
    <meta property="og:image"
      content="https://nroclan.com/static/sonic/img/graph_clan.png?v=333">
    <meta property="og:image:secure_url"
      content="https://nroclan.com/static/sonic/img/graph_clan.png?v=333">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:type" content="image/png">

    <meta name="zalo-platform-site-verification"
      content="NFRX0zp4P2a0mSmmzC1yDGZs_07aW2nTDJ8v" />

    <!-- Google tag (gtag.js) -->
    <script async
      src="https://www.googletagmanager.com/gtag/js?id=AW-17645127478"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date()); gtag('config', 'AW-17645127478');
  </script>
  </head>

  <body>
    <!-- FAB Messenger (TRONG body) -->
    <button
      id="ndxMsgrFab"
      class="ndx-msgr-fab is-unread"
      data-badge="1"
      aria-label="Mở chat Messenger fanpage"
      title="Chat Fanpage">
      <svg viewBox="0 0 36 36" aria-hidden="true" focusable="false">
        <path
          d="M18 3C9.716 3 3 9.268 3 17.5c0 4.39 1.994 8.317 5.183 10.943.202.162.327.401.34.659l.07 4.102a.9.9 0 0 0 1.297.79l4.581-2.226a1.05 1.05 0 0 1 .6-.083c.877.128 1.78.195 2.63.195 8.284 0 15-6.268 15-14.5S26.284 3 18 3Zm8.088 10.78-4.957 5.26a1.8 1.8 0 0 1-2.444.175l-2.62-2.094a.9.9 0 0 0-1.13-.014l-5.08 3.91c-.636.49-1.48-.283-1.04-.95l4.957-5.26a1.8 1.8 0 0 1 2.444-.175l2.62 2.094a.9.9 0 0 0 1.13.014l5.08-3.91c.635-.49 1.48.283 1.04.95Z"></path>
      </svg>
    </button>

    <div id="msgrHint" class="ndx-hint" role="status" aria-live="polite"
      aria-hidden="true">
      Chat "xin code" để nhận bộ giftcode xịn nhá!
      <button class="ndx-hint-close" type="button"
        aria-label="Đóng gợi ý">&times;</button>
    </div>

    <header class="appbar">
      <a class="brand" href="./" aria-label="TDStudio Home">
        <img src="assets/logo.png" alt="TDStudio" />
      </a>
      <nav class="appbar-actions">
        <a class="action-btn" href="register.html">Đăng ký</a>
        <a class="action-btn" href="download.html">Tải game</a>
      </nav>
    </header>

    <main class="page">

      <!-- NDx HERO -->
      <section class="ndx-hero-mini" aria-labelledby="ndx-hero-title">
        <div class="ndx-hero-wrap">
          <h2 id="ndx-hero-title" class="ndx-hero-title">Ngọc Rồng Mobile –
            TDStudio</h2>
          <p class="ndx-hero-sub">Cộng đồng đông vui, cập nhật đều, sự kiện mỗi
            tuần. Tạo nhân vật mới nhận quà tân thủ “cực đã”.</p>
          <div class="ndx-hero-actions">
            <button id="ndx-btn-register" class="ndx-btn ndx-btn-primary">Đăng
              ký</button>
            <button id="ndx-btn-comm" class="ndx-btn ndx-btn-primary">Tham gia
              cộng đồng</button>
            <a id="ndx-btn-comm" style="text-decoration: none; font-size: 12px;"
              class="ndx-btn ndx-btn-primary"
              href="download.html">
              Tải game
            </a>
          </div>
        </div>
      </section>

      <!-- MODAL: Đăng ký -->
      <div id="ndx-modal-register" class="ndx-modal" aria-hidden="true"
        role="dialog" aria-modal="true">
        <div class="ndx-modal-backdrop" data-ndx-close></div>
        <div class="ndx-modal-dialog" role="document"
          aria-labelledby="ndx-reg-title">
          <button class="ndx-modal-close" data-ndx-close
            aria-label="Đóng">×</button>
          <h3 id="ndx-reg-title" class="ndx-modal-title">Chọn server để đăng
            ký</h3>
          <div id="ndx-server-list"
            class="ndx-server-list"><!-- render --></div>
          <div class="ndx-modal-actions">
            <button class="ndx-btn ndx-btn-ghost" data-ndx-close>Đóng</button>
            <button id="ndx-submit" class="ndx-btn ndx-btn-primary"
              disabled>Đăng ký</button>
          </div>
        </div>
      </div>

      <!-- MODAL: Cộng đồng -->
      <div id="ndx-modal-comm" class="ndx-modal" aria-hidden="true"
        role="dialog" aria-modal="true">
        <div class="ndx-modal-backdrop" data-ndx-close></div>
        <div class="ndx-modal-dialog" role="document"
          aria-labelledby="ndx-comm-title">
          <button class="ndx-modal-close" data-ndx-close
            aria-label="Đóng">×</button>
          <h3 id="ndx-comm-title" class="ndx-modal-title">Tham gia cộng
            đồng</h3>
          <div class="ndx-comm-tabs"
            id="ndx-comm-tabs"><!-- render types --></div>
          <div class="ndx-comm-links"
            id="ndx-comm-links"><!-- render links --></div>
          <div class="ndx-modal-actions">
            <button class="ndx-btn ndx-btn-ghost" data-ndx-close>Đóng</button>
          </div>
        </div>
      </div>

      <section class="hero">
        <!-- NÚT đi đến trang bộ sưu tập ảnh -->
        <div class="hero__quick"
          style="display:flex;justify-content:center;margin-top:16px;">
          <a class="quick"
            href="gallery.html"
            rel="nofollow"
            style="
       display:inline-flex;
       align-items:center;
       justify-content:center;
       gap:8px;
       text-decoration:none;
       color:#fff;
       background:linear-gradient(90deg,#0ea5e9,#0284c7);
       font-weight:600;
       font-size:15px;
       border-radius:12px;
       padding:12px 24px;
       width:100%;
       max-width:320px;
       border:1px solid rgba(255,255,255,0.15);
       transition:background 0.25s ease,transform 0.15s ease;
     "
            onmouseover="this.style.background='linear-gradient(90deg,#38bdf8,#0ea5e9)';this.style.transform='translateY(-1px)'"
            onmouseout="this.style.background='linear-gradient(90deg,#0ea5e9,#0284c7)';this.style.transform='none'">
            <svg class="quick__icon" viewBox="0 0 24 24" fill="none"
              stroke="currentColor" stroke-width="1.8" stroke-linecap="round"
              stroke-linejoin="round" aria-hidden="true"
              style="width:20px;height:20px;stroke:currentColor;">
              <rect x="3" y="3" width="18" height="18" rx="4"></rect>
              <path d="M8 14l3-3 2 2 3-3"></path>
            </svg>
            <span>Xem bộ sưu tập ảnh</span>
          </a>
        </div>

        <picture>
          <source type="image/avif" srcset="assets/gallery/1.png">
          <img
            src="assets/gallery/1.png"
            alt="Sự kiện nổi bật"
            width="1280" height="540"
            decoding="async"
            fetchpriority="high"
            style="aspect-ratio:1280/540;width:100%;height:auto;object-fit:cover">
        </picture>

      </section>

      <!-- News / Posts -->
      <section class="section section-news">
        <div class="section__head">
          <h2>TIN TỨC</h2>
          <a class="see-all" href="#" id="xemtatca">Xem tất cả <span
              class="arrow">›</span></a>
        </div>
        <div id="posts" class="posts"></div>
        <div class="news__actions"><button class="btn" id="loadMorePosts">Tải
            thêm</button></div>
      </section>

      <!-- Footer -->
      <footer class="footer">
        <img src="assets/logo.png" alt="TDStudio" class="footer-logo">
        <p class="footer-contact">
          Contact: <a
            href="https://www.facebook.com/ngocrongnthevmax">Fanpage</a> ·
          Email: <a href="mailto:admin@thanhdi.com">admin@thanhdi.com</a>
        </p>
        <p class="footer-text small">TDStudio is an indie team creating unique
          and fun games. We focus on engaging gameplay, original art, and
          ongoing improvements for players.</p>
        <p class="footer-copy">© 2025 ThanhDi Studio – All rights reserved.</p>
      </footer>
    </main>

    <!-- Bottom Tab Bar -->
    <nav
      style="position:fixed;bottom:0;left:0;right:0;display:grid;grid-template-columns:repeat(5,1fr);background:linear-gradient(180deg,rgba(20,22,33,.95),rgba(20,22,33,.95));border-top:1px solid rgba(255,255,255,.08);padding:6px 6px calc(10px + env(safe-area-inset-bottom));z-index:50;">
      <a href="https://www.facebook.com/ngocrongnthevmax" target="_blank"
        rel="noopener"
        style="display:grid;place-items:center;gap:4px;text-decoration:none;color:#cbd5e1;padding:8px 0;border-radius:12px;font-size:12px;font-weight:500;">
        <svg viewBox="0 0 256 256"
          style="width:22px;height:22px;fill:currentColor;">
          <path
            d="M128 24a104 104 0 1 0 104 104A104.2 104.2 0 0 0 128 24Zm20 112h-12v48a8 8 0 0 1-16 0v-48h-8a8 8 0 0 1 0-16h8v-8c0-15.5 9.9-28 24-28h12a8 8 0 0 1 0 16h-12c-4.3 0-8 4.5-8 12v8h12a8 8 0 0 1 0 16Z" />
        </svg>
        <span>Fanpage</span>
      </a>

      <a href="./" id="btnGiftcode"
        style="display:grid;place-items:center;gap:4px;text-decoration:none;color:#cbd5e1;padding:8px 0;border-radius:12px;font-size:12px;font-weight:500;">
        <svg viewBox="0 0 256 256"
          style="width:22px;height:22px;fill:currentColor;">
          <path
            d="M208 72h-21.1a36 36 0 1 0-58.9-40.6A36 36 0 1 0 69.1 72H48a16 16 0 0 0-16 16v32a8 8 0 0 0 8 8h8v88a16 16 0 0 0 16 16h128a16 16 0 0 0 16-16v-88h8a8 8 0 0 0 8-8V88a16 16 0 0 0-16-16Zm-56-24a20 20 0 1 1-20 20 20 20 0 0 1 20-20Zm-64 0a20 20 0 1 1-20 20 20 20 0 0 1 20-20ZM128 216H80v-88h48Zm48 0h-32v-88h32Zm32-104H48V88h160Z" />
        </svg>
        <span>Giftcode</span>
      </a>

      <a href="./"
        style="display:grid;place-items:center;gap:4px;text-decoration:none;color:#fff;padding:8px 0;border-radius:12px;font-size:12px;font-weight:500;background:rgba(255,255,255,.05);border:1px solid rgba(255,255,255,.08);">
        <svg viewBox="0 0 256 256"
          style="width:22px;height:22px;fill:currentColor;">
          <path
            d="M218.8 106.3 136 34.7a15.9 15.9 0 0 0-21.1 0l-82.7 71.6A16 16 0 0 0 24 118.3V208a16 16 0 0 0 16 16h56a8 8 0 0 0 8-8v-56h48v56a8 8 0 0 0 8 8h56a16 16 0 0 0 16-16v-89.7a16 16 0 0 0-5.2-11.3Z" />
        </svg>
        <span>Home</span>
      </a>

      <a href="https://thanhdi.top/contact.html"
        style="display:grid;place-items:center;gap:4px;text-decoration:none;color:#cbd5e1;padding:8px 0;border-radius:12px;font-size:12px;font-weight:500;">
        <svg viewBox="0 0 256 256"
          style="width:22px;height:22px;fill:currentColor;">
          <path
            d="M221.6 158.5a54.3 54.3 0 0 0-43.5-21.4 55.8 55.8 0 0 0-17.8 2.9 8.4 8.4 0 0 0-5.1 10.1l10.1 35.2a4 4 0 0 1-1 3.9l-11.5 11.6a152.5 152.5 0 0 1-60.3-60.3l11.6-11.5a4 4 0 0 1 3.9-1l35.2 10.1a8.4 8.4 0 0 0 10.1-5.1A55.8 55.8 0 0 0 118.9 78a54.3 54.3 0 0 0-21.4-43.5 12.3 12.3 0 0 0-13.5-1.6l-28 12.7a16.2 16.2 0 0 0-8.9 11.6C37 88.5 42 139 84 181s92.5 47 123.8 37.1a16.2 16.2 0 0 0 11.6-8.9l12.7-28a12.3 12.3 0 0 0-1.5-13.7Z" />
        </svg>
        <span>Contact</span>
      </a>

      <a href="https://thanhdi.top/privacy.html"
        style="display:grid;place-items:center;gap:4px;text-decoration:none;color:#cbd5e1;padding:8px 0;border-radius:12px;font-size:12px;font-weight:500;">
        <svg viewBox="0 0 256 256"
          style="width:22px;height:22px;fill:currentColor;">
          <path
            d="M208 40H48a8 8 0 0 0-8 8v56c0 88 77.2 119.4 85.1 122.5a7.7 7.7 0 0 0 5.8 0c7.9-3.1 85.1-34.5 85.1-122.5V48a8 8 0 0 0-8-8Zm-42.3 72.3-40 40a8.1 8.1 0 0 1-11.4 0l-20-20a8 8 0 0 1 11.4-11.4l14.3 14.4 34.3-34.4a8 8 0 0 1 11.4 11.4Z" />
        </svg>
        <span>Privacy</span>
      </a>
    </nav>

    <!-- Giftcode Modal -->
    <div class="modal" id="giftcodeModal" aria-hidden="true" role="dialog"
      aria-modal="true">
      <div class="modal__backdrop" data-close="giftcode"></div>
      <div class="modal__dialog" role="document">
        <header class="modal__head">
          <h3>Giftcode</h3>
          <button class="icon-btn close" aria-label="Đóng"
            data-close="giftcode">×</button>
        </header>
        <div class="modal__body">
          <p class="muted">Nhấn <b>Copy</b> để sao chép nhanh mã.</p>
          <ul class="gift-list" id="giftList"><!-- app.js render --></ul>
        </div>
        <footer class="modal__foot">
          <button class="btn" id="copyAllGift">Copy tất cả</button>
          <button class="btn btn-ghost" data-close="giftcode">Đóng</button>
        </footer>
      </div>
    </div>

    <!-- Toast -->
    <div class="toast" id="toast"></div>

    <!-- App logic -->
    <script src="app.js"></script>

    <!-- Cảnh báo in-app browser (Facebook/IG/Zalo...) -->
    <script>
(function(){
  const GAP_X = 12;  // cách ngang giữa FAB và hint
  const GAP_Y = 6;   // cách dọc giữa FAB và hint
  const fab  = document.getElementById('ndxMsgrFab');
  const hint = document.getElementById('msgrHint');
  if (!fab || !hint) return;

  function placeHint(){
    const r = fab.getBoundingClientRect();
    const vv = window.visualViewport;
    let vw = window.innerWidth, vh = window.innerHeight, offX = 0, offY = 0;
    if (vv) { vw = vv.width; vh = vv.height; offX = vv.offsetLeft || 0; offY = vv.offsetTop || 0; }

    const right  = Math.max(0, (vw + offX) - r.left + GAP_X);
    const bottom = Math.max(0, (vh + offY) - r.bottom + GAP_Y);
    hint.style.right  = right + 'px';
    hint.style.bottom = bottom + 'px';
  }

  function showHint(){
    hint.classList.add('show');
    hint.setAttribute('aria-hidden','false');
    placeHint();
  }

  function hideHint(){
    hint.classList.remove('show');
    hint.setAttribute('aria-hidden','true');
  }

  // ⚡ Tự hiện sau 1.2s MỖI LẦN LOAD
  window.addEventListener('load', () => setTimeout(showHint, 1200), { once:true });

  // Recanh vị trí khi thay đổi viewport
  ['resize','scroll','orientationchange','visibilitychange'].forEach(ev=>{
    window.addEventListener(ev, placeHint, { passive:true });
  });
  if (window.visualViewport){
    ['resize','scroll'].forEach(ev=>{
      window.visualViewport.addEventListener(ev, placeHint, { passive:true });
    });
  }

  hint.querySelector('.ndx-hint-close')?.addEventListener('click', hideHint);
  fab.addEventListener('click', hideHint);
})();
</script>

    <script>
  (function(){
    var ua = navigator.userAgent || "";
    var isMessenger   = /Messenger|FBAN\/Messenger|FB_IAB/i.test(ua);
    var isFacebookApp = /(FBAN|FBAV|FB_IAB|FB4A|com\.facebook\.katana)/i.test(ua);
    var isInstagram   = /Instagram/i.test(ua);
    var isTikTok      = /TikTok/i.test(ua);
    var isZalo        = /Zalo|zclient|ZaloTheme/i.test(ua);
    var isLine        = /Line\/|LINE/i.test(ua);
    var isTwitterApp  = /\bTwitter|X\/\d+/i.test(ua);
    var isSnap        = /Snapchat/i.test(ua);

    var isAndroid = /Android/i.test(ua);
    var isIOS     = /iPhone|iPad|iPod/i.test(ua);

    var appName = isMessenger ? "Messenger"
               : isFacebookApp ? "Facebook"
               : isInstagram ? "Instagram"
               : isTikTok ? "TikTok"
               : isZalo ? "Zalo"
               : isLine ? "LINE"
               : isTwitterApp ? "X (Twitter)"
               : isSnap ? "Snapchat"
               : "";

    if (!appName) return;

    var suggest = isAndroid ? "Chrome" : (isIOS ? "Safari" : "trình duyệt trên máy");

    var bar = document.createElement("div");
    bar.setAttribute("role", "alert");
    bar.style.cssText =
      "position:fixed;top:0;left:0;right:0;z-index:999999;background:#ffeeba;color:#111;padding:14px;text-align:center;" +
      "font:700 18px/1.4 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;border-bottom:1px solid #e0c46c";
    bar.innerHTML =
      "Bạn đang mở trang chủ trên <b>"+appName+"</b>. " +
      "Hãy copy link và mở bằng <b>"+suggest+"</b> để có thể đăng ký và tải game.<br>" +
      '<button id="copyLinkBtn" style="font-weight:700;padding:8px 14px;margin-top:8px;border:1px solid #bfa34e;background:#ffd966;cursor:pointer;border-radius:6px;">Copy link</button>' +
      '<div id="copyStatus" style="margin-top:6px;font-weight:600;color:#0a7c2f;display:none;">Đã copy link! Hãy mở bằng '+suggest+' trên máy của bạn.</div>';

    document.body.appendChild(bar);
    document.body.style.marginTop = (bar.getBoundingClientRect().height) + "px";

    document.getElementById("copyLinkBtn").onclick = function(){
      var url = "https://thanhdi.top";
      function done(){ document.getElementById("copyStatus").style.display = "block"; }
      if (navigator.clipboard && navigator.clipboard.writeText) {
        navigator.clipboard.writeText(url).then(done, fallback);
      } else { fallback(); }
      function fallback(){
        var ta = document.createElement("textarea"); ta.value = url; document.body.appendChild(ta);
        ta.select(); document.execCommand("copy"); document.body.removeChild(ta); done();
      }
    };
  })();
  </script>

    <!-- FAB Messenger handler: mobile -> m.me, desktop -> fanpage -->
    <script>
  (function () {
    const PAGE_USERNAME = "ngocrongnthevmax";
    const MME_URL = `https://m.me/${encodeURIComponent(PAGE_USERNAME)}`;
    const FANPAGE_URL = `https://facebook.com/${encodeURIComponent(PAGE_USERNAME)}`;

    const isMobileUA = () =>
      /Android|iPhone|iPad|iPod|IEMobile|Windows Phone|Mobile Safari|Mobile/i
        .test(navigator.userAgent || "");

    function handleClick(e) {
      e.preventDefault();
      if (isMobileUA()) {
        // Mobile: mở m.me (OS ưu tiên mở app Messenger nếu có)
        window.location.href = MME_URL;
      } else {
        // Desktop: mở fanpage tab mới
        window.open(FANPAGE_URL, "_blank", "noopener,noreferrer");
      }
    }

    function bind() {
      const el = document.getElementById("ndxMsgrFab");
      if (el) el.addEventListener("click", handleClick, { passive: false });
    }

    if (document.readyState === "loading") {
      document.addEventListener("DOMContentLoaded", bind, { once: true });
    } else {
      bind();
    }
  })();
  </script>
  </body>
</html>
